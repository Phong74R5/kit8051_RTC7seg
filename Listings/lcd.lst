C51 COMPILER V9.60.7.0   LCD                                                               09/15/2024 21:14:28 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE LCD
OBJECT MODULE PLACED IN .\Objects\lcd.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE lcd.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\lcd.l
                    -st) TABS(2) OBJECT(.\Objects\lcd.obj)

line level    source

   1          #include<reg51.h>
   2          #include "lcd.h"
   3          #include "delay.h"
   4          
   5           
   6          #define dataport P1       // LCD dataport connected to PORT1
   7           
   8          sbit rs= dataport^0;      // Register select pin connected to P1.0
   9          sbit rw= dataport^1;      // Read Write pin connected to P1.1
  10          sbit en= dataport^2;      // Enable pin connected to P1.2
  11           
  12           
  13           
  14          /* 16x2 lcd Specification */
  15          #define LCDMaxLines 2
  16          #define LCDMaxChars 16
  17          #define LineOne 0x80
  18          #define LineTwo 0xc0
  19           
  20          
  21           
  22          #define BlankSpace ' '
  23           
  24           
  25           
  26           
  27           
  28           
  29           
  30          //LCD initilization
  31          void LCD_Init()
  32          {
  33   1          delay_us(5000);
  34   1         lcd_WriteCmd(0x02);  //initilize the LCD in 4bit Mode
  35   1         lcd_WriteCmd(0x28);
  36   1         lcd_WriteCmd(0x0C);  // display ON cursor ON
  37   1         lcd_WriteCmd(0x01);  // clear the LCD
  38   1         lcd_WriteCmd(0x80);  // move the Cursor to First line First Position
  39   1       
  40   1      }
  41           
  42           
  43          // lcd Write command function
  44          void lcd_WriteCmd( char a)
  45          {
  46   1       
  47   1         dataport=(a & 0xf0);        
  48   1         rs=0;                      
  49   1         rw=0;                 
  50   1         en=1;                 
  51   1         delay_us(1);
  52   1         en=0;
  53   1         delay_us(1);                  
  54   1         dataport=((a<<4) & 0xf0);   
C51 COMPILER V9.60.7.0   LCD                                                               09/15/2024 21:14:28 PAGE 2   

  55   1         rs=0;                    
  56   1         rw=0;                    
  57   1         en=1;                      
  58   1         delay_us(1);
  59   1         en=0;
  60   1         delay_us(1);
  61   1      }
  62           
  63           
  64           // lcd writedata function
  65          void lcd_Writedata( char a)
  66          {
  67   1       
  68   1       
  69   1         dataport=(a & 0xf0);        
  70   1           rs=1;                      
  71   1           rw=0;                      
  72   1           en=1;                      
  73   1          delay_us(1);
  74   1           en=0;
  75   1       
  76   1         delay_us(1);                
  77   1       
  78   1         dataport=((a <<4) & 0xf0);  
  79   1           rs=1;                    
  80   1           rw=0;                     
  81   1           en=1;                      
  82   1          delay_us(1);
  83   1           en=0;
  84   1       
  85   1         delay_us(1);
  86   1       
  87   1      }
  88          
  89           
  90           //lcd gotolinetwo fuction
  91          void lcd_GoToLineTwo()
  92          {
  93   1         lcd_WriteCmd(LineTwo);   // move the Cursor to Second line First Position
  94   1      }
  95           
  96           
  97           
  98          //lcd go to X(first row), Y(second row) line
  99          void lcd_GoToXY(char row, char col)
 100          {
 101   1         char pos;
 102   1       
 103   1          if(row<LCDMaxLines)
 104   1            {
 105   2               pos= LineOne | (row << 6);
 106   2                                          
 107   2       
 108   2              if(col<LCDMaxChars)
 109   2                 pos= pos+col;            
 110   2                                          
 111   2       
 112   2               lcd_WriteCmd(pos);        
 113   2             }
 114   1      }
 115           
 116          
C51 COMPILER V9.60.7.0   LCD                                                               09/15/2024 21:14:28 PAGE 3   

 117          //lcd display string function
 118          void lcd_DisplayString(char *string_ptr)
 119          {
 120   1         while(*string_ptr)
 121   1          lcd_Writedata(*string_ptr++);
 122   1          }
 123           
 124           
 125          //lcd display rtc time function
 126          void lcd_DisplayRtcTime(char hour,char min,char sec)
 127          {
 128   1          lcd_Writedata(((hour>>4) & 0x0f) + 0x30);
 129   1          lcd_Writedata((hour & 0x0f) + 0x30);
 130   1          lcd_Writedata(':');
 131   1       
 132   1          lcd_Writedata(((min>>4) & 0x0f) + 0x30);
 133   1          lcd_Writedata((min & 0x0f) + 0x30);
 134   1          lcd_Writedata(':');
 135   1       
 136   1          lcd_Writedata(((sec>>4) & 0x0f) + 0x30);
 137   1          lcd_Writedata((sec & 0x0f) + 0x30);
 138   1       
 139   1       }
 140           
 141           
 142           // lcd display rtc date function
 143          void lcd_DisplayRtcDate(char day,char month,char year)
 144           {
 145   1           lcd_Writedata(((day>>4) & 0x0f) + 0x30);
 146   1           lcd_Writedata((day & 0x0f) + 0x30);
 147   1           lcd_Writedata('/');
 148   1       
 149   1           lcd_Writedata(((month>>4) & 0x0f) + 0x30);
 150   1           lcd_Writedata((month & 0x0f) + 0x30);
 151   1           lcd_Writedata('/');
 152   1       
 153   1           lcd_Writedata(((year>>4) & 0x0f) + 0x30);
 154   1           lcd_Writedata((year & 0x0f) + 0x30);
 155   1       
 156   1       }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    373    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----      11
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
